# Third Exercise – Joke Combiner API

This project is an Express.js API that fetches random Chuck Norris and Dad jokes, pairs them, and combines them into a new joke. Optionally, it can use a Large Language Model (LLM) to generate creative combined jokes.

## Features

- Fetches 5 random Chuck Norris jokes and 5 random Dad jokes.
- Combines each pair into a single joke (basic concatenation or via LLM).
- REST API endpoint to retrieve the combined jokes.
- Optional LLM integration using HuggingFace Inference API.
- Swagger UI documentation available.

## Requirements

- Node.js (v18+ recommended)
- npm
- (Optional) HuggingFace Inference API key for LLM-powered joke combination

## Setup

1. **Install dependencies:**
   ```bash
   npm install
   ```

2. **Environment variables:**

   Create a `.env` file in the root of `third-exercise/` with the following (if using LLM):
   ```
   LLM_API_KEY=your_huggingface_inference_api_key
   ```
   To get an API key, you should create an account at [https://huggingface.co/](huggingface.co) and then navigate to [https://huggingface.co/settings/tokens](huggingface.co/settings/tokens). When creating a token, make sure you select **Make calls to Inference Providers** in the **Inference** section, as it is the service we are using. This service was selected as it is free to register and get some credit for this usecase.

3. **Run the server:**
   ```bash
   npm start
   ```
   The server will run at [http://localhost:3000](http://localhost:3000).

## API Usage

### Get Combined Jokes

- **Endpoint:** `GET /emparejados`
- **Query Parameters:**
  - `useLLM` (optional, boolean): If `true`, uses LLM to combine jokes. Default is `false`.

**Example:**
```
GET http://localhost:3000/api/v1/chistes/emparejados in Postman

or 

curl -X GET http://localhost:3000/api/v1/chistes/emparejados
```

**Response:**
```json
[
  {
    "chuck": "Chuck Joke 1.",
    "dad": "dad joke 1",
    "combinado": "Chuck Joke 1. Also, dad joke 1"
  },
  ...
]
```
- If `useLLM=true` and a valid API key is provided, the `combinado` field will be generated by the LLM.

**Response:**
```json
[
  {
    "chuck": "Chuck Norris never wipes his butt",
    "dad": "what do you get if you cross a turkey with a ghost? A poultry-geist!",
    "combinado": "Chuck Norris never wipes his butt, and if you cross him with a turkey, you'll get a poultry-geist that will haunt you with endless rounds of butt-kicking, so don't even think about it."
  },
  ...
]
```

**Example:**
```
GET http://localhost:3000/api/v1/chistes/emparejados?useLLM=true

or 

curl -X GET "http://localhost:3000/api/v1/chistes/emparejados?useLLM=true"
```

## Testing

Run tests with:
```bash
npm test
```

## Project Structure

- `src/app.ts` – Main Express app
- `src/routes/jokes.routes.ts` – Jokes API route
- `src/services/joke.services.ts` – Joke fetching and combining logic
- `src/docs/` – Swagger documentation (not actually implemented)